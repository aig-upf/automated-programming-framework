(define (domain blocks)
  (:requirements :typing)
  (:types block)
  (:predicates (on ?x ?y - block)
               (ontable ?x - block)
               (clear ?x - block)
               (hold ?x - block)
               (green ?x - block)
               (have ?x - block)
               (empty)(finished)
               (obs-greenish)(holding-greenish))

  (:action unstack
    :parameters ()
    :precondition ( and (not (finished)))
    :effect ( and ( forall (?x ?y - block)
        (and (when (and  (clear ?x) (on ?x ?y) (empty))
               (and (hold ?x) (clear ?y) (not (clear ?x))
                    (not (on ?x ?y)) (not (empty)))
             )
             (when (and (clear ?x) (ontable ?x) (empty))
               (and (hold ?x) (not (clear ?x))
                    (not (ontable ?x)) (not (empty)))
             )
        ) )
      )
  )

  (:action drop
    :parameters ()
    :precondition ( and (not (finished)))
    :effect ( and ( forall (?x - block)
        (when (and (hold ?x))
          (and (empty) (not (hold ?x))))
      ) )
  )
  (:action collect
    :parameters ()
    :precondition ( and (not (finished)))
    :effect ( and ( forall (?x - block)
        (when (and (hold ?x))
          (and (have ?x) (empty) (finished) (not (hold ?x))))
      ) )
  )

  (:derived (obs-greenish)
    (exists (?x - block) (and (clear ?x) (green ?x))))
  (:derived (holding-greenish)
    (exists (?x - block) (and (hold ?x) (green ?x))))

)

